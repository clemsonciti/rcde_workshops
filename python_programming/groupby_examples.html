
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Split, Apply, Combine &#8212; Research Computing and Data Workshop</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Loading, viewing, and saving" href="wattai_pandas_intro.html" />
    <link rel="prev" title="Introduction to Python III" href="03-IntroToPython-III.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Research Computing and Data Workshop</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Research Computing and Data Workshops
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introductory Sequence
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro_linux/00-index.html">
   Introduction to Linux
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/00a-outline.html">
     Workshop Outline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/01-introduction.html">
     What is Linux?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/01a-shell.html">
     Shell Specifics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/02-accessing-palmetto.html">
     Accessing the Palmetto Cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/03-file-system.html">
     Navigating Files and Directories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/04-working_with_files_and_directories.html">
     Working With Files and Directories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/04a-file-permissions.html">
     File Permissions and Atrributes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/05-pipes.html">
     Pipes and Redirection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/06-find.html">
     Finding Things
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/07-utilities.html">
     Utilities and Useful Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_linux/08-conclusion.html">
     Workshop Conclusion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro_palmetto/00-index.html">
   Introduction to Palmetto
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/01-introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/02-accessing-palmetto.html">
     Accessing the Palmetto Cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/03-palmetto_structure.html">
     The structure of the Palmetto Cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/04-storage.html">
     Storage on Palmetto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/05-interactive.html">
     Running an interactive job on Palmetto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/06-file-transfer.html">
     Transferring files to and from Palmetto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/07-open-od.html">
     Web-based access to the Palmetto Cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro_palmetto/08-batch.html">
     Running a batch job
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  R
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../r_programming/00-index.html">
   Introduction to R
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/01-Introduction.html">
     Introduction to R”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/02-Basic-R.html">
     Basics of R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/03-Data-Structures.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/04-Matrix.html">
     Vectors, Matrices, Lists and Data Frames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/05-Control-Structure.html">
     Control Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/06-Functions.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/07-Parallel-Computing.html">
     Parallel Computing in R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/08-Basic-Plotting.html">
     Basic plotting with R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/09-Plotting-with-ggplot.html">
     Ploting with ggplot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_programming/10-R-in-Palmetto.html">
     R in Palmetto
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../r_machine_learning/00-index.html">
   Machine Learning using R
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/01-Introduction.html">
     Introduction to Machine Learning”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/02-Caret-Preprocessing.html">
     Introduction to Caret
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/03-Caret-Data-Partition.html">
     Data Partition with caret
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/05-Training_Regression.html">
     Training Machine Learning model using Regression Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/06-Decision_boundaries.html">
     Classification with decision boundaries”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/07-KNN.html">
     Nearest Neighbours Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/08-Training_Tree.html">
     Training Machine Learning model using Tree-based model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/09-Training_Ensemble.html">
     Training Machine Learning model using Ensemble approach”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/10-Unsupervised-Learning.html">
     Unsupervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r_machine_learning/11-Neural-Network.html">
     Neural Network
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00-index.html">
   Introduction to Python Programming
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01-IntroToPython-I.html">
     Introduction to Python I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-IntroToPython-II.html">
     Introduction to Python II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-IntroToPython-III.html">
     Introduction to Python III
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Split, Apply, Combine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wattai_pandas_intro.html">
     Loading, viewing, and saving
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python_sklearn/00-index.html">
   Machine Learning using Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/01-introduction.html">
     Introduction to Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/02-sklearn-preprocessing.html">
     Introduction to Scikit Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/03-sklearn-Data-Partition.html">
     Data partition: training and testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/04-sklearn-Evaluation-Metrics.html">
     Evaluation Metrics with Scikit-Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/05-Training-Regression.html">
     Supervised Learning training with Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/06-Training-Tree.html">
     Tree-based Learning Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/07-Training-Ensemble.html">
     Ensemble-based Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/08-Model_Based.html">
     Model-based Prediction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/09-Regularization.html">
     Regularization and Variable Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/10-Dimension-Reduction.html">
     Dimension Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/11-Neural-Network.html">
     Neural Network
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/12-Support-Vector-Machine.html">
     Support Vector Machine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/13-KNN.html">
     K-Nearest Neighbour
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/14-Unsupervised-Learning.html">
     Unsupervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_sklearn/15-Mini-Project.html">
     Mini-Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python_deep_learning/00-index.html">
   Deep Learning in Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/01-Introduction.html">
     Introduction to Deep Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/02-Deep-Learning-Framework.html">
     Deep Learning Library Framework
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/03-Neural-Network.html">
     Recap on ANN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/04-Intro-to-Keras.html">
     Introduction to Keras
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/05-Keras-Regression.html">
     Training Deep Learning Regression model with Keras
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/06-Keras-Classification.html">
     Training Deep Learning Classification model with Keras
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/07-Convolution-Neural-Network.html">
     Convolution Neural Network for image classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_deep_learning/08-Recurrent-neural-networks.html">
     Recurrent Neural Network for Timeseries forecasting
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced Palmetto Usage
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../containers/00-index.html">
   Containerization on Palmetto (under development)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../containers/01-introduction.html">
     Introduction to CloudLab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../containers/02-dockers.html">
     Docker Containers on CloudLab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../containers/03-apptainers.html">
     Singularity/Apptainers on Palmetto
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advanced_scheduling/00-index.html">
   Advanced Scheduling (under development)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced_scheduling/01-introduction.html">
     1. What is Spark?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/clemsonciti/rcde_workshops/master?urlpath=tree/docs/python_programming/groupby_examples.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/python_programming/groupby_examples.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Split, Apply, Combine
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupby">
     <code class="docutils literal notranslate">
      <span class="pre">
       groupby
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply">
   <code class="docutils literal notranslate">
    <span class="pre">
     apply
    </span>
   </code>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Split, Apply, Combine</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Split, Apply, Combine
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupby">
     <code class="docutils literal notranslate">
      <span class="pre">
       groupby
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply">
   <code class="docutils literal notranslate">
    <span class="pre">
     apply
    </span>
   </code>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="split-apply-combine">
<h1>Split, Apply, Combine<a class="headerlink" href="#split-apply-combine" title="Permalink to this headline">#</a></h1>
<p>“Split, Apply, Combine” refers to the common practice of splitting up a dataset into relevant chunks, doing some computation on those chunks, then combining the output into a single table. In pandas, we can break up the data into groups using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method. We can then apply our computation on the grouped data. If we set things up right, pandas will combine the results automatically. <a class="reference external" href="https://andeekaplan.com/images/blog/01202014split-apply-combine.png">Image credit</a>.</p>
<p><img alt="Split apply combine" src="https://raw.githubusercontent.com/clemsonciti/rcde_workshops/master/fig/split-apply-combine.png" /></p>
<p>We will work with the famous <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/iris">iris dataset</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://gist.githubusercontent.com/netj/8836201/raw/6f9306ad21398ea43cba4f7d537619d0e07d5ae3/iris.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<section id="groupby">
<h2><code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#groupby" title="Permalink to this headline">#</a></h2>
<p>Group by allows us to split up the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># what do we get just call groupby? </span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">)</span>
<span class="c1"># answer: a special DataFrameGroupBy object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f8df8d1de70&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can iterate over this data structure manually: </span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">):</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setosa
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>Setosa</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Versicolor
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>50</th>
      <td>7.0</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>1.4</td>
      <td>Versicolor</td>
    </tr>
    <tr>
      <th>51</th>
      <td>6.4</td>
      <td>3.2</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>Versicolor</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Virginica
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>6.3</td>
      <td>3.3</td>
      <td>6.0</td>
      <td>2.5</td>
      <td>Virginica</td>
    </tr>
    <tr>
      <th>101</th>
      <td>5.8</td>
      <td>2.7</td>
      <td>5.1</td>
      <td>1.9</td>
      <td>Virginica</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can even perform split-apply-combine manually</span>
<span class="c1"># for instance, we can compute the average &#39;sepal.length&#39; for each set</span>

<span class="n">variety</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sepal_length</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># 1. Split</span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">):</span> 
    <span class="n">variety</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="c1"># 2. Apply:</span>
    <span class="n">sepal_length</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;sepal.length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    
<span class="c1"># 3. Combine</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;variety&#39;</span><span class="p">:</span> <span class="n">variety</span><span class="p">,</span> <span class="s1">&#39;sepal.length&#39;</span><span class="p">:</span> <span class="n">sepal_length</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variety</th>
      <th>sepal.length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Setosa</td>
      <td>5.006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Versicolor</td>
      <td>5.936</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Virginica</td>
      <td>6.588</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># but this is such a common workflow that pandas makes it easy</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;sepal.length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variety</th>
      <th>sepal.length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Setosa</td>
      <td>5.006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Versicolor</td>
      <td>5.936</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Virginica</td>
      <td>6.588</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and, using the pandas way, we can compute the mean of all variables without writing more code</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variety</th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Setosa</td>
      <td>5.006</td>
      <td>3.428</td>
      <td>1.462</td>
      <td>0.246</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Versicolor</td>
      <td>5.936</td>
      <td>2.770</td>
      <td>4.260</td>
      <td>1.326</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Virginica</td>
      <td>6.588</td>
      <td>2.974</td>
      <td>5.552</td>
      <td>2.026</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can even compute multiple metrics per column using the `agg` method:</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;sem&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="c1"># advanced note: because we have multiple functions for each variable, pandas has created a multi-index for the columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">sepal.length</th>
      <th colspan="4" halign="left">sepal.width</th>
      <th colspan="4" halign="left">petal.length</th>
      <th colspan="4" halign="left">petal.width</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>sem</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>sem</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>sem</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>sem</th>
      <th>count</th>
    </tr>
    <tr>
      <th>variety</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Setosa</th>
      <td>5.006</td>
      <td>0.352490</td>
      <td>0.049850</td>
      <td>50</td>
      <td>3.428</td>
      <td>0.379064</td>
      <td>0.053608</td>
      <td>50</td>
      <td>1.462</td>
      <td>0.173664</td>
      <td>0.024560</td>
      <td>50</td>
      <td>0.246</td>
      <td>0.105386</td>
      <td>0.014904</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Versicolor</th>
      <td>5.936</td>
      <td>0.516171</td>
      <td>0.072998</td>
      <td>50</td>
      <td>2.770</td>
      <td>0.313798</td>
      <td>0.044378</td>
      <td>50</td>
      <td>4.260</td>
      <td>0.469911</td>
      <td>0.066455</td>
      <td>50</td>
      <td>1.326</td>
      <td>0.197753</td>
      <td>0.027966</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>6.588</td>
      <td>0.635880</td>
      <td>0.089927</td>
      <td>50</td>
      <td>2.974</td>
      <td>0.322497</td>
      <td>0.045608</td>
      <td>50</td>
      <td>5.552</td>
      <td>0.551895</td>
      <td>0.078050</td>
      <td>50</td>
      <td>2.026</td>
      <td>0.274650</td>
      <td>0.038841</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pretty colors if you want</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;sem&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_f28a1_row0_col0, #T_f28a1_row0_col1, #T_f28a1_row0_col2, #T_f28a1_row0_col3, #T_f28a1_row0_col7, #T_f28a1_row0_col8, #T_f28a1_row0_col9, #T_f28a1_row0_col10, #T_f28a1_row0_col11, #T_f28a1_row0_col12, #T_f28a1_row0_col13, #T_f28a1_row0_col14, #T_f28a1_row0_col15, #T_f28a1_row1_col3, #T_f28a1_row1_col4, #T_f28a1_row1_col5, #T_f28a1_row1_col6, #T_f28a1_row1_col7, #T_f28a1_row1_col11, #T_f28a1_row1_col15, #T_f28a1_row2_col3, #T_f28a1_row2_col7, #T_f28a1_row2_col11, #T_f28a1_row2_col15 {
  background-color: #f7fbff;
  color: #000000;
}
#T_f28a1_row0_col4, #T_f28a1_row0_col5, #T_f28a1_row0_col6, #T_f28a1_row2_col0, #T_f28a1_row2_col1, #T_f28a1_row2_col2, #T_f28a1_row2_col8, #T_f28a1_row2_col9, #T_f28a1_row2_col10, #T_f28a1_row2_col12, #T_f28a1_row2_col13, #T_f28a1_row2_col14 {
  background-color: #08306b;
  color: #f1f1f1;
}
#T_f28a1_row1_col0 {
  background-color: #4e9acb;
  color: #f1f1f1;
}
#T_f28a1_row1_col1, #T_f28a1_row1_col2 {
  background-color: #529dcc;
  color: #f1f1f1;
}
#T_f28a1_row1_col8 {
  background-color: #3282be;
  color: #f1f1f1;
}
#T_f28a1_row1_col9, #T_f28a1_row1_col10 {
  background-color: #1a68ae;
  color: #f1f1f1;
}
#T_f28a1_row1_col12 {
  background-color: #4896c8;
  color: #f1f1f1;
}
#T_f28a1_row1_col13, #T_f28a1_row1_col14 {
  background-color: #5ca4d0;
  color: #f1f1f1;
}
#T_f28a1_row2_col4 {
  background-color: #b3d3e8;
  color: #000000;
}
#T_f28a1_row2_col5, #T_f28a1_row2_col6 {
  background-color: #dceaf6;
  color: #000000;
}
</style>
<table id="T_f28a1">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_f28a1_level0_col0" class="col_heading level0 col0" colspan="4">sepal.length</th>
      <th id="T_f28a1_level0_col4" class="col_heading level0 col4" colspan="4">sepal.width</th>
      <th id="T_f28a1_level0_col8" class="col_heading level0 col8" colspan="4">petal.length</th>
      <th id="T_f28a1_level0_col12" class="col_heading level0 col12" colspan="4">petal.width</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_f28a1_level1_col0" class="col_heading level1 col0" >mean</th>
      <th id="T_f28a1_level1_col1" class="col_heading level1 col1" >std</th>
      <th id="T_f28a1_level1_col2" class="col_heading level1 col2" >sem</th>
      <th id="T_f28a1_level1_col3" class="col_heading level1 col3" >count</th>
      <th id="T_f28a1_level1_col4" class="col_heading level1 col4" >mean</th>
      <th id="T_f28a1_level1_col5" class="col_heading level1 col5" >std</th>
      <th id="T_f28a1_level1_col6" class="col_heading level1 col6" >sem</th>
      <th id="T_f28a1_level1_col7" class="col_heading level1 col7" >count</th>
      <th id="T_f28a1_level1_col8" class="col_heading level1 col8" >mean</th>
      <th id="T_f28a1_level1_col9" class="col_heading level1 col9" >std</th>
      <th id="T_f28a1_level1_col10" class="col_heading level1 col10" >sem</th>
      <th id="T_f28a1_level1_col11" class="col_heading level1 col11" >count</th>
      <th id="T_f28a1_level1_col12" class="col_heading level1 col12" >mean</th>
      <th id="T_f28a1_level1_col13" class="col_heading level1 col13" >std</th>
      <th id="T_f28a1_level1_col14" class="col_heading level1 col14" >sem</th>
      <th id="T_f28a1_level1_col15" class="col_heading level1 col15" >count</th>
    </tr>
    <tr>
      <th class="index_name level0" >variety</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
      <th class="blank col9" >&nbsp;</th>
      <th class="blank col10" >&nbsp;</th>
      <th class="blank col11" >&nbsp;</th>
      <th class="blank col12" >&nbsp;</th>
      <th class="blank col13" >&nbsp;</th>
      <th class="blank col14" >&nbsp;</th>
      <th class="blank col15" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f28a1_level0_row0" class="row_heading level0 row0" >Setosa</th>
      <td id="T_f28a1_row0_col0" class="data row0 col0" >5.006000</td>
      <td id="T_f28a1_row0_col1" class="data row0 col1" >0.352490</td>
      <td id="T_f28a1_row0_col2" class="data row0 col2" >0.049850</td>
      <td id="T_f28a1_row0_col3" class="data row0 col3" >50</td>
      <td id="T_f28a1_row0_col4" class="data row0 col4" >3.428000</td>
      <td id="T_f28a1_row0_col5" class="data row0 col5" >0.379064</td>
      <td id="T_f28a1_row0_col6" class="data row0 col6" >0.053608</td>
      <td id="T_f28a1_row0_col7" class="data row0 col7" >50</td>
      <td id="T_f28a1_row0_col8" class="data row0 col8" >1.462000</td>
      <td id="T_f28a1_row0_col9" class="data row0 col9" >0.173664</td>
      <td id="T_f28a1_row0_col10" class="data row0 col10" >0.024560</td>
      <td id="T_f28a1_row0_col11" class="data row0 col11" >50</td>
      <td id="T_f28a1_row0_col12" class="data row0 col12" >0.246000</td>
      <td id="T_f28a1_row0_col13" class="data row0 col13" >0.105386</td>
      <td id="T_f28a1_row0_col14" class="data row0 col14" >0.014904</td>
      <td id="T_f28a1_row0_col15" class="data row0 col15" >50</td>
    </tr>
    <tr>
      <th id="T_f28a1_level0_row1" class="row_heading level0 row1" >Versicolor</th>
      <td id="T_f28a1_row1_col0" class="data row1 col0" >5.936000</td>
      <td id="T_f28a1_row1_col1" class="data row1 col1" >0.516171</td>
      <td id="T_f28a1_row1_col2" class="data row1 col2" >0.072998</td>
      <td id="T_f28a1_row1_col3" class="data row1 col3" >50</td>
      <td id="T_f28a1_row1_col4" class="data row1 col4" >2.770000</td>
      <td id="T_f28a1_row1_col5" class="data row1 col5" >0.313798</td>
      <td id="T_f28a1_row1_col6" class="data row1 col6" >0.044378</td>
      <td id="T_f28a1_row1_col7" class="data row1 col7" >50</td>
      <td id="T_f28a1_row1_col8" class="data row1 col8" >4.260000</td>
      <td id="T_f28a1_row1_col9" class="data row1 col9" >0.469911</td>
      <td id="T_f28a1_row1_col10" class="data row1 col10" >0.066455</td>
      <td id="T_f28a1_row1_col11" class="data row1 col11" >50</td>
      <td id="T_f28a1_row1_col12" class="data row1 col12" >1.326000</td>
      <td id="T_f28a1_row1_col13" class="data row1 col13" >0.197753</td>
      <td id="T_f28a1_row1_col14" class="data row1 col14" >0.027966</td>
      <td id="T_f28a1_row1_col15" class="data row1 col15" >50</td>
    </tr>
    <tr>
      <th id="T_f28a1_level0_row2" class="row_heading level0 row2" >Virginica</th>
      <td id="T_f28a1_row2_col0" class="data row2 col0" >6.588000</td>
      <td id="T_f28a1_row2_col1" class="data row2 col1" >0.635880</td>
      <td id="T_f28a1_row2_col2" class="data row2 col2" >0.089927</td>
      <td id="T_f28a1_row2_col3" class="data row2 col3" >50</td>
      <td id="T_f28a1_row2_col4" class="data row2 col4" >2.974000</td>
      <td id="T_f28a1_row2_col5" class="data row2 col5" >0.322497</td>
      <td id="T_f28a1_row2_col6" class="data row2 col6" >0.045608</td>
      <td id="T_f28a1_row2_col7" class="data row2 col7" >50</td>
      <td id="T_f28a1_row2_col8" class="data row2 col8" >5.552000</td>
      <td id="T_f28a1_row2_col9" class="data row2 col9" >0.551895</td>
      <td id="T_f28a1_row2_col10" class="data row2 col10" >0.078050</td>
      <td id="T_f28a1_row2_col11" class="data row2 col11" >50</td>
      <td id="T_f28a1_row2_col12" class="data row2 col12" >2.026000</td>
      <td id="T_f28a1_row2_col13" class="data row2 col13" >0.274650</td>
      <td id="T_f28a1_row2_col14" class="data row2 col14" >0.038841</td>
      <td id="T_f28a1_row2_col15" class="data row2 col15" >50</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="apply">
<h1><code class="docutils literal notranslate"><span class="pre">apply</span></code><a class="headerlink" href="#apply" title="Permalink to this headline">#</a></h1>
<p>The above methods worked because pandas implements special “mean”, “std”, “sem”, and “count”
for the grouped data frame object. But what if we want to apply some strange function
to the grouped data, and pandas doesn’t implement that function?</p>
<p>For example, say we wanted to apply standard-normal scaling to the <code class="docutils literal notranslate"><span class="pre">sepal.length</span></code> variable within each
<code class="docutils literal notranslate"><span class="pre">variety</span></code> group? If <span class="math notranslate nohighlight">\(x\)</span> is <code class="docutils literal notranslate"><span class="pre">sepal.length</span></code>, we want to compute a new variable
$<span class="math notranslate nohighlight">\(
x' = \frac{x - \mu_x}{\sigma_x}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\mu_x<span class="math notranslate nohighlight">\( and \)</span>\sigma_x$ are computed separately within each <code class="docutils literal notranslate"><span class="pre">variety</span></code>.</p>
<p>How do we do this in pandas? This is where the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method comes in. Though apply is very powerful and takes some getting used to. See <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/groupby.html">the documentation</a> for more tricks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first define a function that applies to a specific element</span>
<span class="k">def</span> <span class="nf">standard_scaler</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert to string and get the first character&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># then use apply to loop the function over the column</span>
<span class="n">df_scaled</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standard_scaler</span><span class="p">)</span>
<span class="n">df_scaled</span>
<span class="c1"># printed out means in each group to prove that scaling was per-group rather than global</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/2g/16vjth1s5y38rsg8fh0yt1_40000gp/T/ipykernel_51556/1893518821.py:7: FutureWarning: Not prepending group keys to the result index of transform-like apply. In the future, the group keys will be included in the index, regardless of whether the applied function returns a like-indexed object.
To preserve the previous behavior, use

	&gt;&gt;&gt; .groupby(..., group_keys=False)

To adopt the future behavior and silence this warning, use 

	&gt;&gt;&gt; .groupby(..., group_keys=True)
  df_scaled = df.set_index(&#39;variety&#39;).groupby(&#39;variety&#39;).apply(standard_scaler)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal.length</th>
      <th>sepal.width</th>
      <th>petal.length</th>
      <th>petal.width</th>
    </tr>
    <tr>
      <th>variety</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Setosa</th>
      <td>0.266674</td>
      <td>0.189941</td>
      <td>-0.357011</td>
      <td>-0.436492</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>-0.300718</td>
      <td>-1.129096</td>
      <td>-0.357011</td>
      <td>-0.436492</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>-0.868111</td>
      <td>-0.601481</td>
      <td>-0.932836</td>
      <td>-0.436492</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>-1.151807</td>
      <td>-0.865288</td>
      <td>0.218813</td>
      <td>-0.436492</td>
    </tr>
    <tr>
      <th>Setosa</th>
      <td>-0.017022</td>
      <td>0.453749</td>
      <td>-0.357011</td>
      <td>-0.436492</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>0.176134</td>
      <td>0.080621</td>
      <td>-0.637803</td>
      <td>0.997633</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>-0.452916</td>
      <td>-1.469783</td>
      <td>-1.000191</td>
      <td>-0.458766</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>-0.138391</td>
      <td>0.080621</td>
      <td>-0.637803</td>
      <td>-0.094666</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>-0.610178</td>
      <td>1.320944</td>
      <td>-0.275415</td>
      <td>0.997633</td>
    </tr>
    <tr>
      <th>Virginica</th>
      <td>-1.081966</td>
      <td>0.080621</td>
      <td>-0.818997</td>
      <td>-0.822865</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original variables:&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;variety&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original variables:
</pre></div>
</div>
<img alt="../_images/groupby_examples_17_1.png" src="../_images/groupby_examples_17_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scaled variables:&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">df_scaled</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scaled variables:
</pre></div>
</div>
<img alt="../_images/groupby_examples_18_1.png" src="../_images/groupby_examples_18_1.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python_programming"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="03-IntroToPython-III.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to Python III</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="wattai_pandas_intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Loading, viewing, and saving</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Linh Ngo<br/>
  
    <div class="extra_footer">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"></a> <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Research Computing and Data Workshops</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>